---
layout: post
title: [Causal Inference] 실무로 통하는 인과추론 - [1] 인과추론 기초와 중요성
date: 2025-01-19 17:00:00
categories: [Causal Inference]
tags: [Causal Inference, Correlation]
math: true
toc: true
render_with_liquid: true
img_path: /assets/img/for_post/
description: 이번 글에서는 인과추론의 기본 개념, 필요성, 실무적 적용 사례를 바탕으로 데이터 기반 의사결정에서 인과추론이 왜 중요한지 살펴본다.
---

## Casual Inference Series

- [x] <span style="color: #07a8f7">[1] **인과추론 기초와 중요성**</span>
- [ ] [2] 무작위 통제 실험
- [ ] [3] 그래프 인과모델
- [ ] [4] 편향 점수
---

> 이번 글에서는 인과추론의 기본 개념, 필요성, 실무적 적용 사례를 바탕으로 데이터 기반 의사결정에서 인과추론이 왜 중요한지 살펴본다.
{: .prompt-info}

---
## 인과추론의 개념 및 목적

인과추론 <sup>Causal Inference</sup> 은 상관관계로부터 인과관계를 추론하는 과학적 방법론이다.

"서로 어떻게 관련이 있는가?"를 넘어, **"무엇이 무엇을 원인으로 만들어내는가?**를 이해하는 데 초점을 맞춘다.

많은 데이터 과학자들은 변수 간 상관관계를 이용해 다른 변수를 예측하는 **머신러닝에 더 초점이 맞춰져 있지만**, 사실 **상관관계**보다 **인과관계**를 파악하는 것이 더 중요한 경우가 많다.

원인과 결과의 관계를 알아야만 **원인에 개입**하여 원하는 결과를 가져올 수 있기 때문이다.

실무자들이 상관관계가 아닌 인과관계에 주목하는 이유는 다음과 같다.

1. **Action**: 지표 간 상관관계만으로 실무자가 문제 해결에 대한 행동 <sup>Action</sup> 을 취할 수 없음

2. **Decision**: 상관관계는 중요하지만, 의사결정 <sup>Decision</sup> 에 활용할 수 없음

3. **Growth**: 인과관계를 파악해야, 유저 경험 개선 및 제품 성장 <sup>Growth</sup> 에 기여할 수 있음

최종적으로, 인과추론을 통해 **현실의 문제를 이해**하고 개인 및 조직 차원에서 **문제를 해결**을 통해 **성장**을 도모할 수 있다.

실무적 차원에서는 구성원들이 더 나은 의사결정을 할 수 있도록 돕고, 사용자 경험을 개선할 수 있다.

---
## 인과추론 활용 사례 

### 1) 가격 할인과 매출 증진

- **가설**: 가격 할인 -> 매출 증진
- **문제**: 회사 규모와 같은 교란 요인이 결과에 영향을 줄 수 있다.
- **해결책**:
   - 1. **무작위 처치 <sup>RCT</sup>: 가격 할인을 랜덤하게 배정
   - 2. **조건부 분석 <sup>Conditioning</sup>: 교란 요인을 통제 변수로 포함해 특정 규모의 회사 대상으로 분석

### 2) 스토어 광고와 전환율 증대

- **가설**: 스토어 광고 -> 전환율 증대
- **스토어 광고 방법**: ASO 최적화 / 마켓 피쳐드 / 인기차트 / 인스톨 캠페인 
- **해결책**: A/B 테스트

---
## 인과추론 기본 용어

- **처치 <sup>treatment</sup>** $T$ : 구하려는 효과에 대한 개입
   - $T = 1$: 처치가 이루어진 상태, $T = 0$: 처치가 이루어지지 않은 상태
   - ex) 가격 할인 여부

- **결과 <sup>outcome</sup>** $Y$ : 처치가 미치는 결과로, 영향을 주려는 변수
   - ex) 주간 판매량

- **개입 <sup>intervention</sup>** $text{do}(.)$ : 인과모델을 개선하여 인과적 질문의 답을 구하는 과정
   - $text{do}(T = t_0)$: 처치 $T$에 개입

- **잠재적 결과 <sup>potential outcome</sup>** $Y_i$ : 처치 여부에 따른 두 결과
   - $Y_i$: 처치가 $t$인 상태일 때, 실험 대상 $i$의 결과는 $Y$가 될 것이다.
   - $$ Y_i = T_iY_{1i} + (1-T_i)Y_{0i} $$

- **사실적 결과 <sup>factual outcome</sup>** $Y_{1i}$ : 관측할 수 있는 한 가지 결과
   - $Y_{1i}$: 처치받는 실험 대상 $i$의 잠재적 결과 

- **반사실적 결과 <sup>counterfactual outcome</sup>** $Y_{0i}$ : 관측할 수 없는 다른 한 가지 결과
   - $Y_{0i}$: 처치받지 않은 실험 대상 $i$의 잠재적 결과

- **개별 처치효과 <sup>individual treatment effect</sup> (ITE)** $$ : 개별 실험 대상에 처치가 결과에 미치는 영향

- **편향 <sup>bias</sup>** : 인과관계와 상관관계를 다르게 만드는 요소

---
## 인과추론의 근본적 문제

인과추론을 통한 질문은 대부분 "만약 <sup>What if?</sup>" 으로 이루어진다.

- 현재 상품의 권장 가격 대신 다른 가격을 적용하면 어떻게 될까요?
- 고객의 신용 한도를 늘리면 은행의 이익은 어떻게 될까요?
- 읽기 시험 점수를 높이려면 정부가 모든 학생에게 태블릿을 지급해야 할까요? 도서관을 지어야 할까요?

> 그러나, **동일한 실험 대상이 처치를 받은 상태와 받지 않은 상태를 동시에 관측할 수 없다**는 문제가 발생한다.
{: .prompt-danger}

앞선 예시를 기준으로, 동일 회사가 할인했을 때의 판매량 $Y_1$과 할인하지 않았을 때의 판매량 $Y_0$을 동시에 관측할 수 없다.

즉, 다음과 같은 **결측치 문제**가 발생한다.

![image](assets/img/for_post/241125-1.png){: width="500"}
_결측치 문제_

그렇다면, 어떻게 이를 해결할 수 있을까?

---
## 인과추론 식별

인과추론의 목표는 관측 데이터에서 잠재적 결과를 바탕으로 인과관계를 식별하는 것이다.

앞서 언급한 근본적 문제로 인해 관측된 사실적 결과와 관측할 수 없는 반사실적 결과 간의 차이를 측정할 수 없다.

이를 해결하기 위해, 두 식별 방법을 활용할 수 있다.

1. **무작위 처치** <sup>Randomized Control Trial, RCT</sup>
- 실험 대상에게 처치를 무작위로 배정하여 교란 요인과 잠재적 결과를 독립적으로 만든다.
- 

---
## 편향



---
## 인과추론 프레임워크

---
## 결론



---
## References

[실무로 통하는 인과추론 with Python](https://product.kyobobook.co.kr/detail/S000212577153)

[실무로 통하는 인과추론 특강](https://youtube.com/playlist?list=PLKKkeayRo4PWuwIL0_C7n_QQQ_at6CpoE&si=ZMGPzCLr-T3EtVM9)